Made PROTECT changes per Tomas' rchk note.